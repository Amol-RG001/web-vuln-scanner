import requests

def scan(url):
    try:
        response = requests.get(url, timeout=5)

        if url.startswith("http://"):
            return {
                "status": "Vulnerable",
                "severity": "High",
                "details": "Site is served over HTTP, which is unencrypted and insecure."
            }

        # Check for HSTS header
        hsts = response.headers.get("Strict-Transport-Security")
        if not hsts:
            return {
                "status": "Warning",
                "severity": "Medium",
                "details": "Site uses HTTPS but lacks HSTS header (Strict-Transport-Security)."
            }

        return {
            "status": "Secure",
            "severity": "Low",
            "details": "Site uses HTTPS and HSTS is properly configured."
        }

    except requests.exceptions.RequestException as e:
        return {
            "status": "Unknown",
            "severity": "Unknown",
            "details": f"Failed to connect to {url}. Error: {str(e)}"
        }
