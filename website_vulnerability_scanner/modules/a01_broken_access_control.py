
import requests

def scan(url):
    test_paths = ['/admin', '/dashboard', '/user/1', '/user/2']
    vulnerable_paths = []

    for path in test_paths:
        try:
            full_url = url.rstrip('/') + path
            response = requests.get(full_url, timeout=5)
            if response.status_code == 200 and "login" not in response.text.lower():
                vulnerable_paths.append(full_url)
        except requests.exceptions.RequestException:
            continue

    if vulnerable_paths:
        return {
            "status": "Vulnerable",
            "severity": "High",
            "details": f"Unauthorized access possible at: <br/>" + "<br/>".join(vulnerable_paths)
        }
    else:
        return {
            "status": "Secure",
            "severity": "Low",
            "details": "All tested endpoints are protected from unauthorized access."
        }

