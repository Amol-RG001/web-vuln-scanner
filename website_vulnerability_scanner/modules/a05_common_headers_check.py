import requests

def check_headers(url):
    try:
        response = requests.get(url, timeout=5)
        headers = response.headers
        results = {}
        missing_headers = []

        security_headers = [
            'Content-Security-Policy',
            'X-Content-Type-Options',
            'Strict-Transport-Security',
            'X-Frame-Options',
            'X-XSS-Protection',
            'Referrer-Policy',
            'Permissions-Policy'
        ]

        for header in security_headers:
            if header not in headers:
                missing_headers.append(header)
            results[header] = header in headers

        if missing_headers:
            return {
                "status": "Vulnerable",
                "severity": "Medium",
                "details": f"Missing security headers: <br/>{'<br/>'.join(missing_headers)}"
            }
        else:
            return {
                "status": "Secure",
                "severity": "Low",
                "details": "All important security headers are present."
            }

    except requests.exceptions.RequestException as e:
        return {
            "status": "Unknown",
            "severity": "Unknown",
            "details": f"Failed to connect to {url}. Error: {str(e)}"
        }
