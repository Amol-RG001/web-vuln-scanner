import requests
from urllib.parse import urljoin

def scan(url):
    payload = "<script>alert(1)</script>"
    test_url = urljoin(url, "?q=" + payload)

    try:
        response = requests.get(test_url, timeout=5)
        if payload in response.text:
            return {
                "status": "Vulnerable",
                "severity": "High",
                "details": f"Reflected XSS payload found at: {test_url}"
            }
        else:
            return {
                "status": "Secure",
                "severity": "Low",
                "details": f"No XSS vulnerability detected at: {test_url}"
            }

    except requests.exceptions.RequestException as e:
        return {
            "status": "Unknown",
            "severity": "Unknown",
            "details": f"Error occurred while scanning: {test_url}<br/>Error: {str(e)}"
        }
