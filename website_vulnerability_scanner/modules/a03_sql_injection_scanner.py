import requests

def scan(url):
    payload = "' OR '1'='1"
    test_url = f"{url}?id={payload}"

    try:
        response = requests.get(test_url, timeout=5)
        if "sql" in response.text.lower() or "syntax" in response.text.lower():
            return {
                "status": "Vulnerable",
                "severity": "High",
                "details": f"SQL error message detected at: {test_url}"
            }
        else:
            return {
                "status": "Secure",
                "severity": "Low",
                "details": f"No SQL errors found at: {test_url}"
            }
    except requests.exceptions.RequestException as e:
        return {
            "status": "Unknown",
            "severity": "Unknown",
            "details": f"Request failed while testing: {test_url}<br/>Error: {str(e)}"
        }
